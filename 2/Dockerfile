#base image - node 사용하고 추가적으로 구성
FROM node

#npm install 같은 명령어를 /app 내에서 실행하고 싶기 때문에 작업 디렉토리를 설정한다.
#docker의 모든 후속 명령이 이제부터 /app에서 실행된다.
WORKDIR /app

#첫번째 경로 = 컨테이너의 외부 경로(이미지로 복사되어야 할 파일들이 있는 곳) , "." => Dockerfile과 같은 폴더에 있다.
#두번째 경로 = 그 이미지를 저장해야하는 내부 경로, 각 컨테이너의 자체 파일 시스템, "./" => docker 컨테이너의 현재 작업 디렉토리 
COPY . /app
#COPY . ./ 과 같이 상대 경로로 표시하여도 된다.

RUN npm install
#항상 명령을 실행하기 이전에, 우리의 로컬 시스템에 특정 포트를 노출하고 싶다는 것을 docker에게 알려야 한다.
EXPOSE 80

#서버를 시작
#RUN node server.js 하면 이미지가 빌드될 때마다 실행되기 때문에 틀리다.
#이미지를 실행하는 것이 아니라, 이미지를 기반으로 컨테이너를 실행한다!!
#CMD를 사용하면, 이미지를기반으로 컨테이너가 시작될 때만 실행된다.
CMD ["node", "server.js"]
